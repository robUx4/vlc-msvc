From a1e08392d7ed96f369b5574a496c6c22cc6b2da1 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Hugo=20Beauz=C3=A9e-Luyssen?= <hugo@beauzee.fr>
Date: Wed, 22 Oct 2014 12:29:17 +0200
Subject: [PATCH 069/128] HACK HACK HACK: Disable some modules the ugly way

---
 modules/access/Makefile.am             | 2 ++
 modules/audio_output/Makefile.am       | 4 ++++
 modules/control/Makefile.am            | 9 ++++++---
 modules/services_discovery/Makefile.am | 2 ++
 modules/video_output/Makefile.am       | 8 ++++++++
 modules/video_splitter/Makefile.am     | 2 ++
 6 files changed, 24 insertions(+), 3 deletions(-)

diff --git a/modules/access/Makefile.am b/modules/access/Makefile.am
index 229dfea..63ab967 100644
--- a/modules/access/Makefile.am
+++ b/modules/access/Makefile.am
@@ -415,7 +415,9 @@ if HAVE_WIN32
 libsmb_plugin_la_LIBADD += -lmpr
 endif
 libsmb_plugin_la_LDFLAGS = $(AM_LDFLAGS) -rpath '$(accessdir)'
+if !HAVE_WINSTORE
 access_LTLIBRARIES += $(LTLIBsmb)
+endif
 EXTRA_LTLIBRARIES += libsmb_plugin.la
 
 libdsm_plugin_la_SOURCES = access/dsm/access.c access/dsm/sd.c
diff --git a/modules/audio_output/Makefile.am b/modules/audio_output/Makefile.am
index 982e2ba..b4d1d37 100644
--- a/modules/audio_output/Makefile.am
+++ b/modules/audio_output/Makefile.am
@@ -79,8 +79,10 @@ libdirectsound_plugin_la_SOURCES = audio_output/directsound.c \
 	audio_output/windows_audio_common.h
 libdirectsound_plugin_la_LIBADD = -lole32
 if HAVE_DIRECTX
+if !HAVE_WINSTORE
 aout_LTLIBRARIES += libdirectsound_plugin.la
 endif
+endif
 
 libkai_plugin_la_SOURCES = audio_output/kai.c
 libkai_plugin_la_LIBADD = $(KAI_LIBS)
@@ -98,8 +100,10 @@ libwaveout_plugin_la_SOURCES = audio_output/waveout.c \
 	audio_output/windows_audio_common.h
 libwaveout_plugin_la_LIBADD = -lwinmm
 if HAVE_WIN32
+if !HAVE_WINSTORE
 aout_LTLIBRARIES += libwaveout_plugin.la
 endif
+endif
 
 libauhal_plugin_la_SOURCES = audio_output/auhal.c \
 	audio_output/TPCircularBuffer.h audio_output/TPCircularBuffer.c
diff --git a/modules/control/Makefile.am b/modules/control/Makefile.am
index 06f258c..6bebf59 100644
--- a/modules/control/Makefile.am
+++ b/modules/control/Makefile.am
@@ -13,8 +13,11 @@ control_LTLIBRARIES = \
 	libdummy_plugin.la \
 	libgestures_plugin.la \
 	libhotkeys_plugin.la \
-	libnetsync_plugin.la \
-	liboldrc_plugin.la
+	libnetsync_plugin.la
+
+if !HAVE_WINSTORE
+control_LTLIBRARIES += liboldrc_plugin.la
+endif
 
 liblirc_plugin_la_SOURCES = control/lirc.c
 liblirc_plugin_la_LIBADD = -llirc_client
@@ -64,8 +67,8 @@ libntservice_plugin_la_SOURCES = control/ntservice.c
 libwin_hotkeys_plugin_la_SOURCES = control/globalhotkeys/win32.c
 libwin_msg_plugin_la_SOURCES = control/win_msg.c
 if HAVE_WIN32
-control_LTLIBRARIES += libntservice_plugin.la
 if !HAVE_WINSTORE
+control_LTLIBRARIES += libntservice_plugin.la
 control_LTLIBRARIES += libwin_hotkeys_plugin.la libwin_msg_plugin.la
 endif
 endif
diff --git a/modules/services_discovery/Makefile.am b/modules/services_discovery/Makefile.am
index 11fca94..71db52b 100644
--- a/modules/services_discovery/Makefile.am
+++ b/modules/services_discovery/Makefile.am
@@ -61,8 +61,10 @@ endif
 
 libwindrive_plugin_la_SOURCES = services_discovery/windrive.c
 if HAVE_WIN32
+if !HAVE_WINSTORE
 sd_LTLIBRARIES += libwindrive_plugin.la
 endif
+endif
 
 libos2drive_plugin_la_SOURCES = services_discovery/os2drive.c
 if HAVE_OS2
diff --git a/modules/video_output/Makefile.am b/modules/video_output/Makefile.am
index fb5b20d..1bdb1d0 100644
--- a/modules/video_output/Makefile.am
+++ b/modules/video_output/Makefile.am
@@ -162,7 +162,9 @@ libdirect2d_plugin_la_CPPFLAGS = $(AM_CPPFLAGS) \
 	-DMODULE_NAME_IS_direct2d
 libdirect2d_plugin_la_LIBADD = -lgdi32 -lole32 -luuid
 libdirect2d_plugin_la_LDFLAGS = $(AM_LDFLAGS) -rpath '$(voutdir)'
+if !HAVE_WINSTORE
 vout_LTLIBRARIES += $(LTLIBdirect2d)
+endif
 EXTRA_LTLIBRARIES += libdirect2d_plugin.la
 
 libdirect3d9_plugin_la_SOURCES = video_output/msw/direct3d9.c \
@@ -174,7 +176,9 @@ libdirect3d9_plugin_la_CPPFLAGS = $(AM_CPPFLAGS) \
 	-DMODULE_NAME_IS_direct3d9
 libdirect3d9_plugin_la_LIBADD = -lgdi32 -lole32 -luuid
 libdirect3d9_plugin_la_LDFLAGS = $(AM_LDFLAGS) -rpath '$(voutdir)'
+if !HAVE_WINSTORE
 vout_LTLIBRARIES += $(LTLIBdirect3d9)
+endif
 EXTRA_LTLIBRARIES += libdirect3d9_plugin.la
 
 libdirect3d11_plugin_la_SOURCES = video_output/msw/direct3d11.c \
@@ -201,8 +205,10 @@ libdirectdraw_plugin_la_CPPFLAGS = $(AM_CPPFLAGS) \
 	-DMODULE_NAME_IS_directdraw
 libdirectdraw_plugin_la_LIBADD = -luser32 -lgdi32 -lole32 -luuid
 if HAVE_DIRECTX
+if !HAVE_WINSTORE
 vout_LTLIBRARIES += libdirectdraw_plugin.la
 endif
+endif
 
 libglwin32_plugin_la_SOURCES = video_output/msw/glwin32.c \
 	video_output/opengl.c video_output/opengl.h \
@@ -213,7 +219,9 @@ libglwin32_plugin_la_CPPFLAGS = $(AM_CPPFLAGS) \
 	-DMODULE_NAME_IS_glwin32
 libglwin32_plugin_la_LIBADD = -lopengl32 -lgdi32 -lole32 -luuid
 libglwin32_plugin_la_LDFLAGS = $(AM_LDFLAGS) -rpath '$(voutdir)'
+if !HAVE_WINSTORE
 vout_LTLIBRARIES += $(LTLIBglwin32)
+endif
 EXTRA_LTLIBRARIES += libglwin32_plugin.la
 
 libwingdi_plugin_la_SOURCES = video_output/msw/wingdi.c \
diff --git a/modules/video_splitter/Makefile.am b/modules/video_splitter/Makefile.am
index f0e023c..b16b44d 100644
--- a/modules/video_splitter/Makefile.am
+++ b/modules/video_splitter/Makefile.am
@@ -12,7 +12,9 @@ libpanoramix_plugin_la_SOURCES = video_splitter/panoramix.c
 libpanoramix_plugin_la_CFLAGS = $(AM_CFLAGS)
 libpanoramix_plugin_la_LIBADD = $(LIBM)
 if HAVE_WIN32
+if !HAVE_WINSTORE
 splitter_LTLIBRARIES += libpanoramix_plugin.la
+endif
 else
 if HAVE_XCB_RANDR
 libpanoramix_plugin_la_CFLAGS += $(XCB_RANDR_CFLAGS)
-- 
1.9.5.msysgit.1

