From 4451352a053b89e2e564d34d69b9fa475b58df89 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Hugo=20Beauz=C3=A9e-Luyssen?= <hugo@beauzee.fr>
Date: Tue, 3 Mar 2015 12:35:18 +0100
Subject: [PATCH 71/74] mkv: ebml: Temporary work around an invalid empty array

---
 modules/demux/mkv/Ebml_parser.cpp | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/modules/demux/mkv/Ebml_parser.cpp b/modules/demux/mkv/Ebml_parser.cpp
index b45a2d5..377c3af 100644
--- a/modules/demux/mkv/Ebml_parser.cpp
+++ b/modules/demux/mkv/Ebml_parser.cpp
@@ -150,12 +150,13 @@ void EbmlParser::Reset( demux_t *p_demux )
 // Define a special Segment context that doesn't allow void/crc32 elements
 static const EbmlSemanticContext & GetEbmlNoGlobal_Context();
 static const EbmlSemanticContext Context_EbmlNoGlobal = EbmlSemanticContext(0, NULL, NULL, *GetEbmlNoGlobal_Context, NULL);
-static const EbmlSemantic EbmlNoGlobal_ContextList[0] =
+static const EbmlSemantic EbmlNoGlobal_ContextList[] =
 {
   //EbmlSemantic(false, false, EBML_INFO(EbmlCrc32)),   ///< EbmlCrc32
   //EbmlSemantic(false, false, EBML_INFO(EbmlVoid)),    ///< EbmlVoid
+  EbmlSemantic(false, false, EBML_INFO(EbmlVoid)), //Dummy element to keep compiler happy
 };
-static const EbmlSemanticContext EbmlNoGlobal_Context = EbmlSemanticContext(countof(EbmlNoGlobal_ContextList), EbmlNoGlobal_ContextList, NULL, *GetEbmlNoGlobal_Context, NULL);
+static const EbmlSemanticContext EbmlNoGlobal_Context = EbmlSemanticContext(countof(EbmlNoGlobal_ContextList) - 1, EbmlNoGlobal_ContextList, NULL, *GetEbmlNoGlobal_Context, NULL);
 static const EbmlSemanticContext & GetEbmlNoGlobal_Context()
 {
   return EbmlNoGlobal_Context;
-- 
2.2.0

