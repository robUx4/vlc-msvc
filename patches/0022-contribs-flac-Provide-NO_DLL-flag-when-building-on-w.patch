From aa01ae24babaf1550d78a41d28976aeef4b0dfc9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Hugo=20Beauz=C3=A9e-Luyssen?= <hugo@beauzee.fr>
Date: Wed, 22 Oct 2014 14:55:03 +0200
Subject: [PATCH 22/79] contribs: flac: Provide NO_DLL flag when building on
 windows

---
 contrib/src/flac/rules.mak | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/contrib/src/flac/rules.mak b/contrib/src/flac/rules.mak
index 7e5ad72..354cb41 100644
--- a/contrib/src/flac/rules.mak
+++ b/contrib/src/flac/rules.mak
@@ -42,10 +42,14 @@ FLACCONF += --disable-asm-optimizations
 endif
 endif
 
+ifdef HAVE_WIN32
+	FLACCFLAGS="-DFLAC__NO_DLL"
+endif
+
 DEPS_flac = ogg $(DEPS_ogg)
 
 .flac: flac
-	cd $< && $(HOSTVARS) ./configure $(FLACCONF)
+	cd $< && $(HOSTVARS) ./configure $(FLACCONF) CFLAGS=$(FLACCFLAGS)
 	cd $</include && $(MAKE) install
 	cd $</src && $(MAKE) -C share install && $(MAKE) -C libFLAC install
 	touch $@
-- 
2.2.0

